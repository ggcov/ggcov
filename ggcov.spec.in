Summary: GTK+ front end for gcov
Name: @PACKAGE@
Version: @VERSION@
Release: 1
Copyright: GPL
Group: Development/C
Source: http://www.alphalink.com.au/~gnb/%{name}/%{name}-%{version}.tar.gz
BuildRoot: /var/tmp/%{name}-root
BuildPreReq: gdbm-devel
Vendor: Greg Banks <gnb@alphalink.com.au>

%description
Ggcov is a simple GUI program for browsing test coverage data
from C programs, and is intended to be a graphical replacement
for the gcov program.  See the ggcov-web package for a WWW
interface.

Test coverage data is produced by programs which have been built
with "gcc -fprofile-arcs -ftest-coverage", and indicate how
many times each line and branch has been executed, cumulatively
over multiple test runs.

%package web
Summary: WWW interface to ggcov
Group: Development/C

%description web
The ggcov-web package provides a WWW interface for browsing
test coverage data from C programs.  See the ggcov package
for text-based and GNOME interfaces.

Test coverage data is produced by programs which have been built
with "gcc -fprofile-arcs -ftest-coverage", and indicate how
many times each line and branch has been executed, cumulatively
over multiple test runs.

%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

%clean
rm -rf $RPM_BUILD_ROOT

@GCONF@%post
@GCONF@export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
@GCONF@gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/ggcov.schemas > /dev/null

%files
%defattr(-,root,root)
%{_bindir}/ggcov
%{_bindir}/tggcov
%{_datadir}/ggcov/*.glade
%{_datadir}/ggcov/*.png
%{_datadir}/gnome/apps/Development/ggcov.desktop
%{_datadir}/pixmaps/ggcov64.png
@GCONF@%{_sysconfdir}/gconf/schemas/ggcov.schemas
%doc NEWS AUTHORS README INSTALL COPYING ChangeLog TODO
%docdir %{_mandir}
%{_mandir}/man1/ggcov.1*

%files web
%defattr(-,root,root)
%{_bindir}/ggcov-webdb
%{_datadir}/ggcov/php
%doc php/ggcov.conf doc/HOWTO.web

%changelog
* Sat Apr 30 2005 Greg Banks <gnb@alphalink.com.au>
- Added new subpackage for web stuff
* Mon Mar 14 2005 Greg Banks <gnb@alphalink.com.au>
- Added gconf schema
* Thu Jul 17 2003 Greg Banks <gnb@alphalink.com.au>
- Full GTK2 features, GNOME desktop file.
* Sat Nov 24 2001 Greg Banks <gnb@alphalink.com.au>
- Building RPM for first release
